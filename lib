local Library = {}

-- Colors and settings
Library.Settings = {
    BGColor = Color3.fromRGB(30, 30, 40),
    TextColor = Color3.fromRGB(220, 220, 220),
    AccentColor = Color3.fromRGB(0, 150, 255),
    Font = Enum.Font.Gotham,
    BoldFont = Enum.Font.GothamBold,
    TabHeight = 30
}

-- Create the window
function Library:CreateWindow(title)
    local window = {}
    setmetatable(window, self)
    self.__index = self

    -- Create screen GUI
    window.ScreenGui = Instance.new("ScreenGui")
    window.ScreenGui.Name = "CombatUI"
    window.ScreenGui.Parent = game:GetService("CoreGui")
    window.ScreenGui.ResetOnSpawn = false

    -- Main frame
    window.MainFrame = Instance.new("Frame")
    window.MainFrame.Name = "MainFrame"
    window.MainFrame.Size = UDim2.new(0, 300, 0, 400)
    window.MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
    window.MainFrame.BackgroundColor3 = self.Settings.BGColor
    window.MainFrame.BorderSizePixel = 0
    window.MainFrame.Parent = window.ScreenGui

    -- Title
    window.Title = Instance.new("TextLabel")
    window.Title.Name = "Title"
    window.Title.Text = title or "COMBAT"
    window.Title.TextColor3 = self.Settings.TextColor
    window.Title.TextSize = 18
    window.Title.Font = self.Settings.BoldFont
    window.Title.Size = UDim2.new(1, 0, 0, 30)
    window.Title.BackgroundTransparency = 1
    window.Title.Parent = window.MainFrame

    -- Tab buttons
    window.TabButtons = Instance.new("Frame")
    window.TabButtons.Name = "TabButtons"
    window.TabButtons.Size = UDim2.new(1, 0, 0, 30)
    window.TabButtons.Position = UDim2.new(0, 0, 0, 30)
    window.TabButtons.BackgroundTransparency = 1
    window.TabButtons.Parent = window.MainFrame

    -- Content frame
    window.ContentFrame = Instance.new("ScrollingFrame")
    window.ContentFrame.Name = "Content"
    window.ContentFrame.Size = UDim2.new(1, 0, 1, -60)
    window.ContentFrame.Position = UDim2.new(0, 0, 0, 60)
    window.ContentFrame.BackgroundTransparency = 1
    window.ContentFrame.ScrollBarThickness = 4
    window.ContentFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    window.ContentFrame.Parent = window.MainFrame

    -- Content layout
    window.ContentLayout = Instance.new("UIListLayout")
    window.ContentLayout.Padding = UDim.new(0, 5)
    window.ContentLayout.Parent = window.ContentFrame

    -- Tabs storage
    window.Tabs = {}
    window.CurrentTab = nil

    -- Add tab method
    function window:AddTab(name)
        local tab = {}
        
        -- Tab button
        tab.Button = Instance.new("TextButton")
        tab.Button.Name = name
        tab.Button.Text = name
        tab.Button.TextColor3 = self.Settings.TextColor
        tab.Button.TextSize = 14
        tab.Button.Font = self.Settings.Font
        tab.Button.Size = UDim2.new(0.25, 0, 1, 0)
        tab.Button.BackgroundTransparency = 1
        tab.Button.Parent = self.TabButtons
        
        -- Tab content
        tab.Frame = Instance.new("Frame")
        tab.Frame.Name = name
        tab.Frame.Size = UDim2.new(1, -10, 0, 0)
        tab.Frame.Position = UDim2.new(0, 5, 0, 0)
        tab.Frame.BackgroundTransparency = 1
        tab.Frame.Visible = false
        tab.Frame.Parent = self.ContentFrame
        
        -- Tab layout
        tab.Layout = Instance.new("UIListLayout")
        tab.Layout.Padding = UDim.new(0, 5)
        tab.Layout.Parent = tab.Frame
        
        -- Tab click handler
        tab.Button.MouseButton1Click:Connect(function()
            if self.CurrentTab then
                self.CurrentTab.Frame.Visible = false
                self.CurrentTab.Button.TextColor3 = self.Settings.TextColor
            end
            self.CurrentTab = tab
            tab.Frame.Visible = true
            tab.Button.TextColor3 = self.Settings.AccentColor
        end)
        
        table.insert(self.Tabs, tab)
        
        -- Set first tab as active
        if #self.Tabs == 1 then
            tab.Button.TextColor3 = self.Settings.AccentColor
            tab.Frame.Visible = true
            self.CurrentTab = tab
        end
        
        -- Add section method
        function tab:AddSection(title)
            local section = {}
            
            -- Section frame
            section.Frame = Instance.new("Frame")
            section.Frame.Name = "Section"
            section.Frame.Size = UDim2.new(1, 0, 0, 0)
            section.Frame.BackgroundTransparency = 1
            section.Frame.Parent = tab.Frame
            
            -- Section layout
            section.Layout = Instance.new("UIListLayout")
            section.Layout.Padding = UDim.new(0, 5)
            section.Layout.Parent = section.Frame
            
            -- Section title
            section.Title = Instance.new("TextLabel")
            section.Title.Name = "Title"
            section.Title.Text = title
            section.Title.TextColor3 = self.Settings.TextColor
            section.Title.TextSize = 16
            section.Title.Font = self.Settings.BoldFont
            section.Title.Size = UDim2.new(1, 0, 0, 20)
            section.Title.BackgroundTransparency = 1
            section.Title.TextXAlignment = Enum.TextXAlignment.Left
            section.Title.Parent = section.Frame
            
            -- Section divider
            section.Divider = Instance.new("Frame")
            section.Divider.Name = "Divider"
            section.Divider.Size = UDim2.new(1, 0, 0, 1)
            section.Divider.Position = UDim2.new(0, 0, 0, 20)
            section.Divider.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
            section.Divider.BorderSizePixel = 0
            section.Divider.Parent = section.Frame
            
            -- Add toggle method
            function section:AddToggle(options)
                local toggle = {}
                options = options or {}
                
                -- Toggle frame
                toggle.Frame = Instance.new("Frame")
                toggle.Frame.Name = "Toggle"
                toggle.Frame.Size = UDim2.new(1, 0, 0, 20)
                toggle.Frame.BackgroundTransparency = 1
                toggle.Frame.Parent = section.Frame
                
                -- Toggle label
                toggle.Label = Instance.new("TextLabel")
                toggle.Label.Name = "Label"
                toggle.Label.Text = options.Text or "Toggle"
                toggle.Label.TextColor3 = self.Settings.TextColor
                toggle.Label.TextSize = 14
                toggle.Label.Font = self.Settings.Font
                toggle.Label.Size = UDim2.new(1, -25, 1, 0)
                toggle.Label.BackgroundTransparency = 1
                toggle.Label.TextXAlignment = Enum.TextXAlignment.Left
                toggle.Label.Parent = toggle.Frame
                
                -- Toggle button
                toggle.Button = Instance.new("TextButton")
                toggle.Button.Name = "Button"
                toggle.Button.Text = ""
                toggle.Button.Size = UDim2.new(0, 20, 0, 20)
                toggle.Button.Position = UDim2.new(1, -20, 0, 0)
                toggle.Button.BackgroundColor3 = options.Default and self.Settings.AccentColor or Color3.fromRGB(80, 80, 80)
                toggle.Button.BorderSizePixel = 0
                toggle.Button.Parent = toggle.Frame
                
                -- Toggle state
                toggle.Value = options.Default or false
                toggle.Callback = options.Callback or function() end
                
                -- Toggle click handler
                toggle.Button.MouseButton1Click:Connect(function()
                    toggle.Value = not toggle.Value
                    toggle.Button.BackgroundColor3 = toggle.Value and self.Settings.AccentColor or Color3.fromRGB(80, 80, 80)
                    toggle.Callback(toggle.Value)
                end)
                
                -- Set method
                function toggle:Set(value)
                    toggle.Value = value
                    toggle.Button.BackgroundColor3 = toggle.Value and self.Settings.AccentColor or Color3.fromRGB(80, 80, 80)
                    toggle.Callback(toggle.Value)
                end
                
                return toggle
            end
            
            return section
        end
        
        return tab
    end

    return window
end

return Library
